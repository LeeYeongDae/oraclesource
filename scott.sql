
SELECT * FROM EMP e;

SELECT e.EMPNO, e.ENAME, e.job FROM EMP e; 

SELECT e.EMPNO, e.DEPTNO FROM EMP e;

SELECT DISTINCT e.EMPNO, e.DEPTNO FROM EMP e;

SELECT  * FROM EMP e ORDER BY e.DEPTNO DESC, e.ENAME ASC;

SELECT * FROM EMP e WHERE e.sal BETWEEN 2000 AND 3000;

SELECT * FROM EMP e WHERE e.ENAME LIKE '_L%';

SELECT * FROM EMP e WHERE e.ENAME LIKE '%AM%';

SELECT * FROM EMP e WHERE e.ENAME NOT LIKE '%AM%';

SELECT * FROM EMP e WHERE e.MGR IS not NULL;

SELECT sysdate AS now, sysdate-1 AS yesterday, sysdate+1 AS tomorrow,
	CURRENT_DATE AS curdate, CURRENT_TIMESTAMP AS curtime
FROM dual;

SELECT sysdate, ADD_MONTHS(sysdate, 3)
FROM dual;

SELECT e.EMPNO, e.ENAME, e.HIREDATE, TRUNC(MONTHS_BETWEEN(sysdate, e.HIREDATE))
FROM EMP e;

SELECT sysdate, NEXT_DAY(sysdate,'월요일'), LAST_DAY(sysdate)
FROM dual;
 	--자동 형변환
SELECT e.EMPNO, e.ENAME, e.EMPNO+'500'
FROM EMP e 
WHERE e.ENAME = 'SMITH';

SELECT TO_CHAR(sysdate,'YYYY/MM/DD, YY MON MONTH DY DAY HH:MI:SS HH12 HH24 AM PM')
FROM dual;

SELECT e.SAL, TO_CHAR(e.SAL, '$999,000')
FROM EMP e;

--empno 99**, ename N****
SELECT e.EMPNO, SUBSTR(e.EMPNO, 0, 2)||'**' AS "EMPNO Masked",
e.ENAME, SUBSTR(e.ENAME, 0, 1)||SUBSTR('********',0,LENGTH(e.ENAME)-1) AS "ENAME Masked"
FROM EMP e;

--평균 근무일 21, 하루 8시간으로 하루 급여(day_pay), 시급(time_pay) / 일급은 소수 셋자리 버림, 시급 두자리 반올림
-- EMPNO, ENAME, SAL, DAY_PAY, TIME_PAY
SELECT e.EMPNO, e.ENAME, e.SAL, TRUNC(e.SAL/21, 2) AS "DAY_PAY", ROUND((e.SAL/21)/8,1) AS "TIME_PAY"
FROM EMP e;

--입사일기준 3개월후 첫 월요일에 정직원, 정직원날짜(R_HOB) YYYY-MM-DD, 추가수당 없으면 N/A 출력
-- EMPNO, ENAME, HIERDARE, R_JOB, COMM
SELECT e.EMPNO, e.ENAME, TO_CHAR(e.HIREDATE,'YYYY-MM-DD') AS "HIREDATE",
TO_CHAR(NEXT_DAY((ADD_MONTHS(e.HIREDATE, 3)),'월요일'),'YYYY-MM-DD') AS "R_JOB", NVL(TO_CHAR(e.COMM), 'N/A') AS "COMM"
FROM EMP e;

--직속상관의 사원번호 X = 0000, 두번째자리 XXXX 5~8만
-- EMPNO, ENAME, MGR, CHG_MGR
SELECT e.EMPNO, e.ENAME, e.MGR, 
CASE WHEN e.MGR IS NULL THEN '0000'
WHEN e.MGR LIKE '75%' THEN '5555'
WHEN e.MGR LIKE '76%' THEN '6666'
WHEN e.MGR LIKE '77%' THEN '7777'
WHEN e.MGR LIKE '78%' THEN '8888'
ELSE TO_CHAR(e.MGR) END AS "CHG_MGR"
FROM EMP e;

SELECT e.EMPNO, e.ENAME, e.MGR, 
DECODE(SUBSTR(TO_CHAR(e.MGR),1,2),
NULL, '0000',
'75', '5555',
'76', '6666',
'77', '7777',
'78', '8888',
TO_CHAR(e.MGR))
FROM EMP e;

SELECT sum(e.sal) FROM EMP e;
SELECT sum(e.sal), sum(DISTINCT e.sal) FROM EMP e;
SELECT count(e.EMPNO) FROM EMP e ;
SELECT MAX(e.SAL), MIN(e.SAL) FROM EMP e ;
SELECT MAX(e.SAL) FROM EMP e WHERE e.DEPTNO = 10;
SELECT MAX(e.HIREDATE), MIN(e.HIREDATE) FROM EMP e WHERE e.DEPTNO = 20;
SELECT AVG(e.SAL) FROM EMP e WHERE e.DEPTNO = 30;

SELECT e.DEPTNO, AVG(e.SAL) FROM EMP e GROUP BY e.DEPTNO;

SELECT e.JOB, COUNT(e.EMPNO) FROM EMP e GROUP BY e.JOB HAVING COUNT(e.empno) >= 3;

SELECT TO_CHAR(e.HIREDATE, 'YYYY'), e.DEPTNO, COUNT(e.EMPNO) FROM EMP e GROUP BY TO_CHAR(e.HIREDATE, 'YYYY'), e.DEPTNO;

SELECT e.EMPNO, e.DEPTNO, d.DNAME, d.LOC FROM EMP e, DEPT d WHERE e.DEPTNO = d.DEPTNO;

SELECT e.EMPNO, e.DEPTNO, e.SAL, d.DNAME, d.LOC FROM EMP e, DEPT d WHERE e.DEPTNO = d.DEPTNO AND e.SAL >= 3000;

SELECT e1.EMPNO, e1.ENAME, e1.MGR, e2.ENAME AS mgr_name FROM EMP e1, EMP e2 WHERE e1.MGR = e2.EMPNO;

SELECT e1.EMPNO, e1.ENAME, e1.MGR, e2.ENAME AS mgr_name FROM EMP e1, EMP e2 WHERE e1.MGR = e2.EMPNO(+);

SELECT e1.EMPNO, e1.ENAME, e1.MGR, e2.ENAME AS mgr_name FROM EMP e1, EMP e2 WHERE e1.MGR(+) = e2.EMPNO;

SELECT * FROM EMP e JOIN SALGRADE s ON e.SAL BETWEEN s.LOSAL AND s.HISAL;

SELECT e1.EMPNO, e1.ENAME, e1.MGR, e2.ENAME AS mgr_name FROM EMP e1 RIGHT OUTER JOIN EMP e2 ON e1.MGR = e2.EMPNO;

--급여 2000 초과 사원의 부서정보, 사원정보
SELECT e.DEPTNO, d.DNAME, e.EMPNO, e.ENAME, e.SAL
FROM EMP e
JOIN DEPT d ON
e.DEPTNO = d.DEPTNO
WHERE e.SAL > 2000;

SELECT e.DEPTNO, d.DNAME, e.EMPNO, e.ENAME, e.JOB, e.SAL
FROM EMP e
JOIN DEPT d ON e.DEPTNO = d.DEPTNO 
ORDER BY e.EMPNO, e.DEPTNO;

--모든 부서정보와 사원 정보를 부서번호 사원번호 순서 정렬
SELECT e.DEPTNO, d.DNAME, e.EMPNO, e.ENAME, e.MGR, e.SAL, s.LOSAL, s.HISAL, s.GRADE, e2.EMPNO AS mgr_empno, e2.ENAME AS mgr_name
FROM EMP e
JOIN DEPT d ON
	e.DEPTNO = d.DEPTNO
JOIN SALGRADE s ON
	e.SAL BETWEEN s.LOSAL AND s.HISAL
LEFT OUTER JOIN EMP e2 ON
	e.MGR = e2.EMPNO
ORDER BY
	e.EMPNO, e.DEPTNO;

SELECT
	d.DEPTNO,
	d.DNAME,
	round(AVG(e.SAL), 0) AS avg_sal,
	min(e.SAL),
	max(e.SAL),
	COUNT(e.EMPNO) AS cnt_emp
FROM
	EMP e
JOIN DEPT d ON
	e.DEPTNO = d.DEPTNO
GROUP BY
	d.DEPTNO,
	d.DNAME;
